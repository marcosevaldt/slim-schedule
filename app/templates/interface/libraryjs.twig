<!-- Body JS-->

  <!-- JQuery Slim 3.1.1 -->
  <script src="{{base_url()}}/bootstrap4/js/jquery-3.1.1.slim.min.js"></script>
  <!-- Tether -->
  <script src="{{base_url()}}/bootstrap4/js/tether.min.js"></script>
  <!-- Bootstrap 3.3.6 -->
  <script src="{{base_url()}}/bootstrap4/js/bootstrap.min.js"></script>
  <!-- Full Calendar 3.5.1 -->
  <script src="{{base_url()}}/calendar/js/moment.min.js"></script>
  <script src="{{base_url()}}/calendar/js/fullcalendar.min.js"></script>
  <script src="{{base_url()}}/calendar/js/pt-br.js"></script>


<!--ENDBODYJS-->

<!--ESTE DEVE SER O ULTIMO POR LOADAR AS CLASSES ACIMA-->
  <!-- Main Script-->
  <script src="{{base_url()}}/plugins/scripts/main.js"></script>

<script>
$(document).ready(function() {

  $('#calendar').fullCalendar({
    eventClick: function(calEvent, jsEvent, view) {
      window.location.href = "http://localhost/calendar/public/home/edit/" + calEvent.id;
    },
    header: {
      left: 'prev,next today',
      center: 'title',
      right: 'month,agendaWeek,agendaDay,listWeek'
    },
    defaultDate: '{{ "now"|date("Y/m/d") }}',
    locale: 'pt-br',
    navLinks: true, // can click day/week names to navigate views
    editable: true,
    eventLimit: true, // allow "more" link when too many events
    events: [
      {% for evento in eventos %}
      {

        id: '{{evento.id}}',
        title: '{{evento.title}}',
        start: '{{evento.start.date}}',
        end: '{{evento.end.date}}'
      },
      {% endfor %}
    ],
    eventResize: function(event, delta, revertFunc) {
        if (!confirm("Deseja mesmo alterar?")) {
            revertFunc();
        }else{
          $.ajax({
              type: "POST",
              url: "/calendar/public/home/update",
              data: {
                id: event.id,
                start: event.start.format(),
                end: event.end.format(),
                title: event.title,
              },   // <== change is here
              success: function(msg){
                  alert('Alterado com sucesso!');
              }
          });
        }
    },
    eventDrop: function(event, delta, revertFunc) {

      if (!confirm("Deseja mesmo alterar?")) {
          revertFunc();
      }else{
        $.ajax({
            type: "POST",
            url: "/calendar/public/home/update",
            data: {
              id: event.id,
              start: event.start.format(),
              end: event.end.format(),
              title: event.title,
            },   // <== change is here
            success: function(msg){
                alert('Alterado com sucesso!');
            }
        });
      }

    }
  });

});

</script>
